<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>プロット編集・閲覧</title>
  <!-- Bootstrap CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body>
<!-- 共通ヘッダー -->
<div th:replace=fragments/header2 :: header2></div>

<div class="container mt-4">
  <!-- ロゴ -->
  <div class="text-center mb-3">
    <img th:src="@{/img/logo.png}" alt="ロゴ" height="60">
  </div>

  <!-- 見出し -->
  <h2 class="text-center mb-3">プロット編集・閲覧</h2>

  <!-- 説明文 -->
  <p>シナリオの部品（プロット）を編集します。フィールドにタイトルやプロットを記入すると自動的に保存されますが、保存ボタンで明示的に保存も可能です。</p>
  <p>新たなプロットを追加したい場合はフィールド横の追加ボタンをクリックしてください。削除したい場合は削除ボタンをクリックしてください。ドラッグ＆ドロップで並び替えも可能です。</p>

  <!-- 保存ボタン（上） -->
  <div class="text-end mb-3">
    <button class="btn btn-primary rounded-pill" id="saveBtnTop">保存</button>
  </div>

  <!-- プロットタイトル -->
  <div class="mb-4">
    <label for="plotTitle" class="form-label fw-bold">プロットタイトル</label>
    <input type="text" class="form-control" id="plotTitle" th:value="${plot.title}" data-plot-id="${plot.id}">
  </div>

  <!-- プロット編集 -->
  <div>
    <label class="form-label fw-bold">プロット編集</label>
    <div id="plotContainer">
      <!-- ループでプロット入力欄を出力 -->
      <div th:each="order, iterStat : ${plotOrders}" class="d-flex align-items-start mb-2 plot-item" th:data-order-id="${order.id}" th:data-order-index="${iterStat.index}">
        <textarea class="form-control me-2 plot-content" style="width: 70%; height: 4em;" th:text="${order.content}"></textarea>
        <button class="btn btn-success rounded-pill me-1 add-btn">追加</button>
        <button class="btn btn-danger rounded-pill delete-btn">削除</button>
      </div>
    </div>
  </div>

  <!-- 保存ボタン（下） -->
  <div class="text-end mt-4">
    <button class="btn btn-primary rounded-pill" id="saveBtnBottom">保存</button>
  </div>
</div>

<!-- 今後のJS追加用 -->
<script>
  // リアルタイム保存処理、追加・削除、並び替え処理はここに書く予定
</script>
</body>
</html>
